(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{486:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"开发手册"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发手册"}},[t._v("#")]),t._v(" 开发手册")]),t._v(" "),s("p",[t._v("本文档描述统一应用平台提供的通用功能、服务和相关接口，指导基于统一应用平台业务应用的开发")]),t._v(" "),s("h2",{attrs:{id:"前端开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端开发"}},[t._v("#")]),t._v(" 前端开发")]),t._v(" "),s("h3",{attrs:{id:"前端工程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端工程"}},[t._v("#")]),t._v(" 前端工程")]),t._v(" "),s("p",[t._v("平台前端基于Vue.js框架开发，应用可以基于Vue.js提供的脚手架工具搭建基本的前端工程，具体方法参考Vue.js官方网站。Vue.js脚手架为用户创建了一套基本工程结构，如果开发人员熟悉前端工程各个配置工具，也可以自行配置工程项目")]),t._v(" "),s("h3",{attrs:{id:"通用服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通用服务"}},[t._v("#")]),t._v(" 通用服务")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("平台前端工程按照公司UX设计规范定义了一套通用的css样式，包含在default.css文件中，各个应用在开发前端时候应该使用此css样式，具体样式文件包括在平台发布的内容中")])]),t._v(" "),s("li",[s("p",[t._v("平台提供了通用ajax网络请求方法，支持POST、DELETE、GET、PUT等，各个应用在开发时候可以直接使用相关API，具体方法请参考平台发布的http.js文件")])]),t._v(" "),s("li",[s("p",[t._v("平台提供了公共的方法，包含登录用户信息，时间格式化，获取token等方法，各个应用在开发时候可以直接使用相关API，具体方法请参考平台发布的common.js文件")])]),t._v(" "),s("li",[s("p",[t._v("平台前端管理登录用户信息，包括当前Token，用户ID和国际化信息等")])]),t._v(" "),s("li",[s("p",[t._v("平台token跟在菜单URL后面传递给界面，第三方应用通过解析url获取token，再通过token调平台/user/session接口，获取相关登录信息")])]),t._v(" "),s("li",[s("p",[t._v("第三方与平台通信用postMessage。支持以下几种")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("界面跳转 消息格式")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("会话超时 消息格式")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Token刷新 消息格式")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'最新的token'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("左边菜单不显示，tab项显示 消息格式")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("具体调用方法：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        top"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'json格式的字符串'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("ol",[s("li",[t._v("传递的消息格式为json格式的字符串")]),t._v(" "),s("li",[t._v("左边菜单不显示，tab项显示中的id为菜单id(定制菜单关联的菜单id)")])])])])]),t._v(" "),s("h3",{attrs:{id:"前端集成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端集成"}},[t._v("#")]),t._v(" 前端集成")]),t._v(" "),s("p",[t._v("平台提供了通用的登录页面和基于用户权限的菜单树生成和加载机制，各个应用需要通过在菜单树新增菜单将应用链接到平台中。对于新的租户应该按照以下顺序对其进行配置（更细节的应用和应用菜单配置可以参考用户手册）：")]),t._v(" "),s("ul",[s("li",[t._v("平台管理员创建新的应用租户")]),t._v(" "),s("li",[t._v("为租户添加菜单定制组合")]),t._v(" "),s("li",[t._v("给新创建的租户添加组织")]),t._v(" "),s("li",[t._v("给新创建的租户添加管理员角色并关联菜单")]),t._v(" "),s("li",[t._v("给新建租户创建管理员用户并分配管理员角色")]),t._v(" "),s("li",[t._v("使用新创建的管理员用户登录")]),t._v(" "),s("li",[t._v("创建应用")]),t._v(" "),s("li",[t._v("重新登录")])]),t._v(" "),s("h3",{attrs:{id:"国际化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#国际化"}},[t._v("#")]),t._v(" 国际化")]),t._v(" "),s("ul",[s("li",[t._v("界面国际化：前端项目基于Vue.js开发，国际化可以直接参考Vue.js官网")]),t._v(" "),s("li",[t._v("菜单国际化：菜单管理界面提供了菜单国际化配置")]),t._v(" "),s("li",[t._v("编码国际化：编码管理界面提供了各个编码国际化配置")]),t._v(" "),s("li",[t._v("错误消息国际化：直接前端显示接口返回的错误消息（message）")])]),t._v(" "),s("h2",{attrs:{id:"后端开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端开发"}},[t._v("#")]),t._v(" 后端开发")]),t._v(" "),s("h3",{attrs:{id:"后端工程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端工程"}},[t._v("#")]),t._v(" 后端工程")]),t._v(" "),s("p",[t._v("平台后端基于Spring Boot开发，封装了一些公共功能和方法，包含在以下jar包，请结合项目实际情况确定是否使用或者参考实现")]),t._v(" "),s("ol",[s("li",[t._v("uap-common：提供了平台接口的请求和响应参数封装、会话对象和其他工具类方法")]),t._v(" "),s("li",[t._v("uap-client：提供权限校验请求工具类，异常拦截、swagger文档、权限拦截等基础的基于spring-boot的注解类")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("如果需要使用上述jar包")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("应用需要在项目的maven配置中加入如下私服地址：")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://172.30.12.181:8081/repository/maven-public",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://172.30.12.181:8081/repository/maven-public"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("在开发应用的pom中添加对jar的依赖，比如对uap-client依赖：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.hexing.uap"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("uap-client"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${uap.project.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("如使用uap-client包")]),t._v(" "),s("p",[t._v('需要添加如下应用的扫描basePackages中，如下：\n@ComponentScan(basePackages = {"com.hexing.uap.client.cfg"})')]),t._v(" "),s("p",[t._v("对于uap-client包，开发应用的properties文件中加入client包下properties文件所提供的信息，如下：")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#平台地址")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.uapUrl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://192.168.15.12:9090/uap")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#本应用在平台的注册码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.appCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#本应用访问平台的密码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.appScret")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#本应用api接口扫描包")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.restBasePackage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#本应用token拦截排除的路径 多个以','隔开")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.excludePathPatterns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n")])])]),s("p",[t._v("uap-client包提供如下功能：")]),t._v(" "),s("ul",[s("li",[t._v("异常拦截器ClientExceptionHandler用以统一处理异常")]),t._v(" "),s("li",[t._v("ApiDocConfig用以配置swagger的地址及相关信息")]),t._v(" "),s("li",[t._v("AbstractClientResourceAspect类用于统一记录接口的访问日志等信息")]),t._v(" "),s("li",[t._v("ClientTokenInterceptor用于统一处理接口访问的权限校验")])])])]),t._v(" "),s("h3",{attrs:{id:"接口规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接口规范"}},[t._v("#")]),t._v(" 接口规范")]),t._v(" "),s("p",[t._v("平台后端接口按照Restful规范设计，接口的url由两部分组成：域名地址和方法映射地址。对于方法映射地址，需要遵循本文档的规范。平台集成了Swagger工具，开发时可以通过Swagger来查看接口详细信息")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Get请求规范")]),t._v(" "),s("p",[t._v("Get请求用于查询，查询参数写在映射地址中，举例如下:")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/getRequest.png"),alt:"image"}}),t._v(" "),s("ul",[s("li",[t._v("在这个接口中"),s("code",[t._v("@ApiOperation")]),t._v("和"),s("code",[t._v("@ApiParam")]),t._v("为Swagger注解，Swagger插件据此生成接口文档和接口信息")]),t._v(" "),s("li",[s("code",[t._v("@GetMapping")]),t._v("为Get请求类型，"),s("code",[t._v('value="/user/{userId}"')]),t._v("为接口的映射地址，"),s("code",[t._v("{userId}")]),t._v("为查询参数，根据restful规范，查询请求的参数要写在映射地址中。")]),t._v(" "),s("li",[s("code",[t._v("@PathVariable")]),t._v("用于获取映射地址中的参数")]),t._v(" "),s("li",[s("code",[t._v("ModelResponse<UapUser>")]),t._v("为接口的返回类型，平台提供三种通用的返回值类型：\n"),s("ol",[s("li",[s("code",[t._v("CommonResponse")]),t._v("，用于返回无返回值的接口，主要用于返回接口的执行结果编码和编码信息")]),t._v(" "),s("li",[s("code",[t._v("ListDataResponse<T>")]),t._v("，用于返回值为list类型的接口")]),t._v(" "),s("li",[s("code",[t._v("ModelResponse<T>")]),t._v("，用于返回值为对象类型的接口")])])]),t._v(" "),s("li",[s("code",[t._v('produces="application/json"')]),t._v("用于声明接口返回值为json格式")])])]),t._v(" "),s("li",[s("p",[t._v("Post请求规范")]),t._v(" "),s("p",[t._v("Post请求用于新增数据或者执行复杂的查询，也可用于复杂的更新、删除操作。举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/postRequest.png"),alt:"image"}}),t._v(" "),s("p",[t._v("post请求的映射地址中不需要添加参数信息\n"),s("code",[t._v("@RequestBody")]),t._v(" 获取参数对象\n"),s("code",[t._v("ValidatortUtil.validate()")]),t._v("是平台提供的参数检验工具，该方法会根据在参数上添加的约束对参数做检验")])]),t._v(" "),s("li",[s("p",[t._v("Put请求规范")]),t._v(" "),s("p",[t._v("Put请求用于更新数据，待更新数据的唯一标识符要放到请求的映射地址中，用于表明要更新哪一条数据。举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/putRequest.png"),alt:"image"}})]),t._v(" "),s("li",[s("p",[t._v("Delete请求")]),t._v(" "),s("p",[t._v("Delete请求用于删除数据，待删除数据的唯一标识符要放到请求的映射地址中。举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/deleteRequest.png"),alt:"image"}})]),t._v(" "),s("li",[s("p",[t._v("接口的参数规范")]),t._v(" "),s("p",[t._v("接口的参数如果为对象，需要在对象的属性上使用Swagger注解用于生成接口文档，对参数的约束信息要添加相关的检验约束，举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/requestParameter.png"),alt:"image"}})])]),t._v(" "),s("h3",{attrs:{id:"国际化-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#国际化-2"}},[t._v("#")]),t._v(" 国际化")]),t._v(" "),s("p",[t._v("每个模块的提示信息的国际化文件都放在各个项目的资源文件目录中，路径一般为/java/Resources/i18n/。在国际化文件夹下存放多个语言的国际化文件。各个模块需要在本模块定义一个切面，切点为本模块的控制层(一般是在rest包里)的Resource文件(有的项目用Controller命名)的所有方法，在该切面中处理所有的返回信息码，并根据当前的系统语言选择对应的国际化文件，填写相应的提示信息。在uap-common.jar包里有提示信息工具类MessageUtil")]),t._v(" "),s("h2",{attrs:{id:"工作流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工作流"}},[t._v("#")]),t._v(" 工作流")]),t._v(" "),s("p",[t._v("平台工作流部分集成了Flowable工作流引擎并在其基础上进行了二次开发，工作流的使用规范符合平台前端、后端开发标准，其中集成的Flowable工作流引擎符合BPMN2.0规范，使用者可以部署BPMN 2.0流程定义（用于定义流程的行业XML标准）， 创建这些流程定义的流程实例，进行查询，访问运行中或历史的流程实例与相关数据等")]),t._v(" "),s("h3",{attrs:{id:"设计流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设计流程"}},[t._v("#")]),t._v(" 设计流程")]),t._v(" "),s("p",[t._v("工作流要求把流程定义为BPMN 2.0格式，这是一个业界广泛接受的XML标准。流程定义可以看做是重复执行流程的蓝图。我们首先需要根据业务使用场景设计画出流程图（具体设计可参照用户手册3.8.1）并将相应的流程节点分配给相关处理人员（可以分配给具体人或具体角色），节点处理人选择页面如下图所示：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/processDesign.png"),alt:"image"}}),t._v(" "),s("h3",{attrs:{id:"部署流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署流程"}},[t._v("#")]),t._v(" 部署流程")]),t._v(" "),s("p",[t._v("流程图设计好之后需要进行部署让其运行于工作流引擎之中，具体部署操作参见用户手册\n"),s("RouterLink",{attrs:{to:"/zh/guide/userManual/08-workflow.html#部署流程"}},[t._v("部署流程")])],1),t._v(" "),s("h3",{attrs:{id:"应用开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用开发"}},[t._v("#")]),t._v(" 应用开发")]),t._v(" "),s("p",[t._v("流程部署完成之后业务应用就可以通过调用平台工作流提供的相应接口去启动流程实例、查询并完成相关任务等。平台工作流接口调用符合平台接口调用规范，需要首先完成相关的权限配置")]),t._v(" "),s("h4",{attrs:{id:"启动流程实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动流程实例"}},[t._v("#")]),t._v(" 启动流程实例")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了启动流程实例的接口："),s("code",[t._v("POST:/bpm/task/start")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("接口参数为json格式，主要包含以下字段："),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务处理URL，当流程节点中未配置处理界面URL时则使用URL，若配置则优先使用节点配置的URL "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessUrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务标识"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务名称"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotNull")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程定义标识，不可超过64位，对应着流程定义界面的Key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processDefinitionKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" startUserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotNull")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"该ID和流程定义标识一起确定需启动的流程，该Id与平台设计创建流程的appId保持一致，需要使用‘应用Id+@@@+租户Id’拼接组成"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" tenappId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"全局变量，可以传入相关业务参数，注：不可使用businessUrl、businessKey、businessName 三个字段作为map的key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" globalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"流程任务查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流程任务查询"}},[t._v("#")]),t._v(" 流程任务查询")]),t._v(" "),s("ul",[s("li",[t._v("流程实例启动后相关人员登录将可以查询到与其有关的流程任务，平台提供了待办任务和已办任务的查询接口："),s("code",[t._v("POST:/bpm/task/history")])]),t._v(" "),s("li",[t._v("平台工作流我的任务部分已实现对该接口的调用参见"),s("RouterLink",{attrs:{to:"/zh/guide/userManual/07-my-task.html"}},[t._v("我的任务")])],1),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("接口参数为json格式，主要包含以下字段："),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true:已办；false:待办"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" finished"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"起始位置，分页使用"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"查询数量，分页使用"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程实例ID"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processInstanceId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"工作项名称模糊查询"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" nameLike"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"环节启动结束时间"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" dueBefore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"环节启动开始时间"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" dueAfter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程启动结束时间"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" createdBefore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程启动开始时间"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" createdAfter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程实例名称模糊查询"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processDefinitionNameLike"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"是同时否根据角色查询，false时只查分配给当前人的任务，true则还会查询分配给所传角色数组的任务"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" isByRole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"配置组合:task:查询待办任务表单/history;查询已办任务表单"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"角色数组，根据角色查询是使用"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" candidateGroups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"签收-取消签收任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#签收-取消签收任务"}},[t._v("#")]),t._v(" 签收/取消签收任务")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了签收任务接口："),s("code",[t._v("POST:/bpm/task/claim/{taskId}")])]),t._v(" "),s("li",[t._v("取消签收接口："),s("code",[t._v("POST:/bpm/task/unclaim/{taskId}")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("平台工作流我的任务部分已实现对该接口的调用参见用户手册"),s("RouterLink",{attrs:{to:"/zh/guide/userManual/07-my-task.html"}},[t._v("我的任务")])],1)]),t._v(" "),s("h4",{attrs:{id:"完成任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完成任务"}},[t._v("#")]),t._v(" 完成任务")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了完成任务的接口："),s("code",[t._v("POST:/bpm/task/complete")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token"),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("若该任务为被委托给当前处理人则需要调用专门的接口处理,如下")])])]),t._v(" "),s("li",[t._v("接口参数为json格式，主要包含以下字段"),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"任务ID"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" taskId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"全局变量"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" globalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"局部变量，只在当前任务中生效"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" localVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"委托任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#委托任务"}},[t._v("#")]),t._v(" 委托任务")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了委托任务接口："),s("code",[t._v("POST:/bpm/task/delegate")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("平台工作流我的任务部分已实现对该接口的调用参见用户手册"),s("RouterLink",{attrs:{to:"/zh/guide/userManual/07-my-task.html"}},[t._v("我的任务")])],1)]),t._v(" "),s("h4",{attrs:{id:"完成委托任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完成委托任务"}},[t._v("#")]),t._v(" 完成委托任务")]),t._v(" "),s("ul",[s("li",[t._v("若该待办列表中存在被委托给当前处理人的任务则完成此类型任务需要调用如下接口：\n"),s("code",[t._v("POST:/bpm/task/resolve")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("接口参数为json格式，主要包含以下字段："),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"任务ID"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" taskId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"全局变量"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" globalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"局部变量，只在当前任务中生效"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" localVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"任务拽回"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#任务拽回"}},[t._v("#")]),t._v(" 任务拽回")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了拽回任务接口："),s("code",[t._v("POST:/bpm/task/revoke")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("平台工作流历史任务部分已实现对该接口的调用参见用户手册"),s("RouterLink",{attrs:{to:"/zh/guide/userManual/07-my-task.html#历史任务"}},[t._v("历史任务")])],1)]),t._v(" "),s("h4",{attrs:{id:"启动并完成第一个节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动并完成第一个节点"}},[t._v("#")]),t._v(" 启动并完成第一个节点")]),t._v(" "),s("ul",[s("li",[t._v("平台工作流提供了启动流程实例并完成第一个节点接口："),s("code",[t._v("POST:/bpm/task/start/first-node")])]),t._v(" "),s("li",[t._v("此接口权限类型为登陆，需要token")]),t._v(" "),s("li",[t._v("该接口针对第一个任务节点配置为“分配给流程启动人”类型的已部署流程调用，改接口会自动执行启动流程实例操作、第一节点设置签收人操作及完成第一节点操作")]),t._v(" "),s("li",[t._v("接口参数为json格式，主要包含以下字段："),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务处理URL，当流程节点中未配置处理界面URL时则使用URL，若配置则优先使用节点配置的URL "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessUrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务标识"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务名称"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" businessName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotNull")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流程定义标识，不可超过64位，对应着流程定义界面的Key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" processDefinitionKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" startUserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotNull")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"该ID和流程定义标识一起确定需启动的流程，该Id与平台设计创建流程的appId保持一致，需要使用‘应用Id+@@@+租户Id’拼接组成"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" tenappId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"全局变量，可以传入相关业务参数，注：不可使用businessUrl、businessKey、businessName 三个字段作为map的key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" globalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"定时任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定时任务"}},[t._v("#")]),t._v(" 定时任务")]),t._v(" "),s("h3",{attrs:{id:"定时任务开发步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定时任务开发步骤"}},[t._v("#")]),t._v(" 定时任务开发步骤")]),t._v(" "),s("p",[t._v("编写定时任务rest接口(job接口)-导入接口脚本-页面配置定时任务-任务执行-调度应用的rest接口-接口反写日志-执行日志查看")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/timedTask.png"),alt:"image"}}),t._v(" "),s("h3",{attrs:{id:"编写rest接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写rest接口"}},[t._v("#")]),t._v(" 编写rest接口")]),t._v(" "),s("p",[t._v("定时任务的调度通过调用rest接口实现，各个模块把本模块要定时执行的任务封装成符合调度规范的rest接口，然后在定时任务配置界面配置执行计划。供调度调用的接口必需满足以下规范：")]),t._v(" "),s("ul",[s("li",[t._v("请求类型为http post请求")]),t._v(" "),s("li",[t._v('映射@PostMapping的value属性必需以"/schedule/"开头')]),t._v(" "),s("li",[t._v("接口的返回值必需是com.hexing.uap.common.bean.CommonResponse对象")]),t._v(" "),s("li",[t._v("接口参数必需是com.hexing.uap.common.bean.JobRestApiRequest对象")]),t._v(" "),s("li",[t._v("该对象包括如下字段：")]),t._v(" "),s("li",[t._v("String param;//接口参数(任务配置界面填写的参数)")]),t._v(" "),s("li",[t._v("Long logId;//本次调用产生的日志标识，如果要反写业务日志，可根据该标识更新日志")]),t._v(" "),s("li",[t._v("Long totalSlice;//分片总数，在调度执行时自动根据可用的执行机数量填写，如果任务不是分片类型，该字段为空")]),t._v(" "),s("li",[t._v("Long slice;//当前属于哪个分片，如果任务不是分片类型，该字段为空")])]),t._v(" "),s("p",[t._v("接口举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/timedRequest.png"),alt:"image"}}),t._v(" "),s("p",[t._v("接口反写日志举例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/timedRequestLog.png"),alt:"image"}}),t._v(" "),s("h3",{attrs:{id:"调度执行过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调度执行过程"}},[t._v("#")]),t._v(" 调度执行过程")]),t._v(" "),s("p",[t._v("当在界面配置完成执行计划后，调度中心就会按照配置定时调度")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("在任务触发后，首先会根据配置的日历类型和能否并行执行检查该任务是否符合要求，对于不满足配置条件的不会继续执行。然后会按照界面配置的接口和参数信息调用业务接口，在调用时会构建JobRestApiRequest对象，并把相关参数填入。业务接口解析JobRestApiRequest对象，得到需要的参数并执行任务。在执行完成后通过CommonResponse对象返回执行结果(成功或失败)。接口调用方式根据是否为微服务部署有所不同：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("非微服务模式，根据接口所属应用（uap_app表）里配置的应用URL和接口的URL拼接成调用URL，发送HTTP POST请求。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("此模式需要保证应用在uap_app表里配置的URL为真实的机器IP和端口。")])]),t._v(" "),s("p",[t._v("示例如下:")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/scheduleExecution1.png"),alt:"image"}})]),t._v(" "),s("li",[s("p",[t._v("微服务模式，调度中心和各个应用实例都注册到同一个注册中心（或注册中心集群）上，调度中心根据接口所属应用（uap_app表）里配置的应用编码（code字段）到注册中心获取应用实例，然后通过该实例发送HTTP POST请求")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("此模式必须保证应用在uap_app表里配置的code字段和应用在微服务中部署的服务名一致")])]),t._v(" "),s("p",[t._v("schedule在uap_app表中的code为uap-schedule，故此处配置的spring.application.name=uap-schedule，示例如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/scheduleExecution2.png"),alt:"image"}})])])]),t._v(" "),s("li",[s("p",[t._v("调度中心调用rest接口采用异步方式，在发送完HTTP请求后，等待5秒，如果没有信息（错误或成功）返回，调度中心自动结束。业务接口在执行完成后，要调用调度中心提供的写日志接口返回执行结果和业务侧的执行日志："),s("RouterLink",{attrs:{to:"/zh/development/#业务侧反写业务日志"}},[t._v("业务日志")])],1)]),t._v(" "),s("li",[s("p",[t._v("调度中心根据以下条件判断任务是否执行完成：")]),t._v(" "),s("ul",[s("li",[t._v("发送异步请求后等待5秒，在此期间如果有信息返回（无论成功或失败），即认为任务已经完成")]),t._v(" "),s("li",[t._v("如果异步请求等待结束，没有信息返回，则会根据业务侧是否反写了日志来判断")]),t._v(" "),s("li",[t._v("如果反写了日志，则认为任务已经完成")]),t._v(" "),s("li",[t._v("如果不满足以上两点，调度中心有个任务最大执行时间的配置项，当超过该时间还没有收到反馈，调度中心也会把该任务标记为已执行完成")])])]),t._v(" "),s("li",[s("p",[t._v("配置")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("    # 任务最大执行时间（秒）\n    uap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("maxExecuteTime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("对于分片的任务，必须所有分片都已执行完成，该任务才算完成，定时任务调度示意图如下:")])])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/taskScheduling.png"),alt:"image"}}),t._v(" "),s("h3",{attrs:{id:"业务侧反写业务日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#业务侧反写业务日志"}},[t._v("#")]),t._v(" 业务侧反写业务日志")]),t._v(" "),s("p",[t._v("业务接口如果要填写业务日志，可以调用调度中心提供的写业务日志接口")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("该接口URL如下："),s("code",[t._v("Put:/schedule/jobLog/{logId}")]),t._v("，其中logId为调度调用接口时传过去的logId")])]),t._v(" "),s("li",[s("p",[t._v("此接口权限类型为无需登陆，可直接调用，不需要token")])]),t._v(" "),s("li",[s("p",[t._v("接口参数为json格式，主要包含以下字段：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务日志,长度最大1024"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务执行时长(毫秒),长度最大10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" costTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务执行结果,长度最大10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"业务出错原因,长度最大255"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" errorReason"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ApiModelProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"当前属于哪个分片，长度不超过10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" slice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("调用该接口方法微服务部署和非微服务有不同:")]),t._v(" "),s("ul",[s("li",[t._v("微服务方式，调用的url为http://uap-schedule/schedule/jobLog/，后面拼接logId，其中uap-schedule为调度中心在注册中心的服务名")]),t._v(" "),s("li",[t._v("非微服务方式，当前比较复杂，要先到uap_app表查询调度中心的应用url，再和接口的url拼接（后续准备优化此过程）")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("由于调度中心采用异步调用，所以一般情况下调度中心无法知道业务接口执行情况,对于不可并行执行的接口一定要反写业务日志，否则调度中心无法控制并行调用")])])])]),t._v(" "),s("h3",{attrs:{id:"检查接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查接口"}},[t._v("#")]),t._v(" 检查接口")]),t._v(" "),s("p",[t._v("job接口开发完成后，把相关的脚本（接口脚本，接口关联菜单），菜单的权限类型为仅登陆。这个过程参考平台部分的应用管理和菜单管理")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("配置完成后检查下平台的接口表(uap_rest_api)、菜单表(uap_menu)。找到接口表中刚才开发的job接口，确保type字段为1，确保菜单表中job接口对应的菜单的auth_type为1")])]),t._v(" "),s("h3",{attrs:{id:"配置执行计划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置执行计划"}},[t._v("#")]),t._v(" 配置执行计划")]),t._v(" "),s("p",[t._v("启动uap，uap-schedule，uap-ui，登陆uap界面，到Task Configuration界面配置执行计划，如下图所示：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/taskConfig.png"),alt:"image"}}),t._v(" "),s("p",[t._v("新增时可配置以下属性，日历功能（Date type），错过处理策略（Miss handling instruction），优先级（priority），排除日期（Exclusion time），路由策略（Route policy），Allow parallel（是否允许并行执行）：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/addTask.png"),alt:"image"}}),t._v(" "),s("h3",{attrs:{id:"执行日志查看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行日志查看"}},[t._v("#")]),t._v(" 执行日志查看")]),t._v(" "),s("p",[t._v("job执行后会在job日志表(uap_job_log)中填写日志信息，可到表中查看job是否执行成功，以及出错原因、执行时间、执行耗时等信息")]),t._v(" "),s("p",[t._v("调度中心有查看日志的界面，也可到界面上查看")]),t._v(" "),s("h2",{attrs:{id:"消息中心"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息中心"}},[t._v("#")]),t._v(" 消息中心")]),t._v(" "),s("h3",{attrs:{id:"消息topic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息topic"}},[t._v("#")]),t._v(" 消息topic")]),t._v(" "),s("p",[t._v("消息中心分为消息topic和消息体两大块，要发送消息，首先要在消息中心创建消息topic,有单独的消息类型管理页面，可以从页面里创建，注意：")]),t._v(" "),s("ul",[s("li",[t._v("消息类型挂在所属应用下，必须选择应用")]),t._v(" "),s("li",[t._v("消息code为调用消息发送接口必传参数，建议创建时建个有意义的code")]),t._v(" "),s("li",[t._v("消息level为这类消息的重要程度划分。\n创建消息类型后要为消息类型分配接收人，有如下分配方式：")]),t._v(" "),s("li",[t._v("租户，只能选择当前用户自己所在的租户，租户下所有用户都能收到这类消息类型下的消息")]),t._v(" "),s("li",[t._v("角色，可多选，选择当前用户下多种角色，角色下用户都能收到消息类型下的消息")]),t._v(" "),s("li",[t._v("人员，可多选")])]),t._v(" "),s("h3",{attrs:{id:"消息发送"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息发送"}},[t._v("#")]),t._v(" 消息发送")]),t._v(" "),s("p",[t._v("配置好消息类型后，就可发送消息，开发人员调用消息发送restful接口发送消息，"),s("code",[t._v("post:/msg/uapMsgInfo")]),t._v(",和调用uap正常接口一样，要传token.参数如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("长度")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("code")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("64")]),t._v(" "),s("td",[t._v("消息类型code")])]),t._v(" "),s("tr",[s("td",[t._v("msg_content")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("2048")]),t._v(" "),s("td",[t._v("消息内容")])]),t._v(" "),s("tr",[s("td",[t._v("msg_title")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("128")]),t._v(" "),s("td",[t._v("消息标题")])]),t._v(" "),s("tr",[s("td",[t._v("sender_nm")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("128")]),t._v(" "),s("td",[t._v("发送方名称")])])])]),t._v(" "),s("p",[t._v("当返回"),s("code",[t._v("code:operate.success")]),t._v("时，说明消息发送成功，可以从消息页面查看新发消息")]),t._v(" "),s("h2",{attrs:{id:"权限管理开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#权限管理开发"}},[t._v("#")]),t._v(" 权限管理开发")]),t._v(" "),s("p",[t._v("如何控制按钮操作权限")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("配置菜单")]),t._v(" "),s("p",[t._v("在菜单配置中，配置到功能菜单时，给某个功能菜单添加上"),s("code",[t._v("code")]),t._v("码，如下图：例如给用户界面的新增用户功能添加一个"),s("code",[t._v("code")]),t._v("为"),s("code",[t._v("ADD")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/rightsManagement.png"),alt:"image"}})]),t._v(" "),s("li",[s("p",[t._v("调uap后端接口")]),t._v(" "),s("p",[t._v("接口为："),s("code",[t._v("/user/function/code")]),t._v("，传入对应界面的菜单定制id用于获取页面所需的权限和编码资源")])]),t._v(" "),s("li",[s("p",[t._v("前端开发")]),t._v(" "),s("p",[t._v("调接口会返回当前界面的权限字段functions数组，如下图：例如用户界面返回")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/functions.png"),alt:"image"}}),t._v(" "),s("p",[t._v("有code为ADD说明有新增权限,反之没有新增权限，对应界面可以做隐藏，置灰，报错等处理")])])]),t._v(" "),s("h3",{attrs:{id:"数据权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据权限"}},[t._v("#")]),t._v(" 数据权限")]),t._v(" "),s("p",[t._v("数据权限功能是对UAP的角色权限功能的增强，此功能能够在角色原有的权限基础上，对数据的权限进行更加细致的划分。")]),t._v(" "),s("p",[t._v("默认数据权限为64位，每位表示不同的数据内容，可以在角色选项卡中为每个角色动态的分配数据权限内容，以达到不同角色有不同的数据权限。")]),t._v(" "),s("h3",{attrs:{id:"开启数据权限功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启数据权限功能"}},[t._v("#")]),t._v(" 开启数据权限功能")]),t._v(" "),s("ol",[s("li",[t._v("登录uap平台，在左侧菜单栏中点击"),s("code",[t._v("Application Settings")]),t._v("选项，选择"),s("code",[t._v("Mulit-tenant management")])]),t._v(" "),s("li",[t._v("在租户列表下，点击"),s("strong",[t._v("设置")]),t._v("按钮")]),t._v(" "),s("li",[t._v("开启"),s("code",[t._v("Data Privilege Enable")])])]),t._v(" "),s("p",[t._v("按照以上步骤能够开启租户的数据权限功能")]),t._v(" "),s("h3",{attrs:{id:"配置数据权限内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置数据权限内容"}},[t._v("#")]),t._v(" 配置数据权限内容")]),t._v(" "),s("ol",[s("li",[t._v("点击"),s("strong",[t._v("Data Privilege")]),t._v("选项卡")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/dataPermissionMenu.jpg"),alt:"数据权限菜单"}}),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("点击每条记录中右侧的编辑按钮")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/dataPermissionEditor.jpg"),alt:"数据权限编辑"}}),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("对每位数据进行编辑即可")])]),t._v(" "),s("h3",{attrs:{id:"增加数据权限位数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增加数据权限位数"}},[t._v("#")]),t._v(" 增加数据权限位数")]),t._v(" "),s("p",[t._v("数据权限默认为"),s("strong",[t._v("64位")]),t._v("数据，如果实际操作中数据类型较大，可以根据一些步骤扩充数据量")]),t._v(" "),s("p",[t._v("点击上图中的"),s("code",[t._v("Extended Digits")]),t._v(" 按钮，选择想要扩充到的位数即可")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/dataPlus.jpg"),alt:"数据权限位数扩充"}}),t._v(" "),s("h3",{attrs:{id:"为角色分配数据权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为角色分配数据权限"}},[t._v("#")]),t._v(" 为角色分配数据权限")]),t._v(" "),s("p",[t._v("数据权限可以对角色的权限进行增强，可以为每个角色分配不同的数据权限，用户可以通过被分配的角色来获取数据权限。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/RolePermission.jpg"),alt:"Role分配权限"}}),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/RolePermissionEditor.jpg"),alt:"Role数据权限编辑"}}),t._v(" "),s("p",[t._v("可以勾选与对应角色相应的数据权限内容，为角色配置权限，"),s("strong",[t._v("Advanced option")]),t._v("勾选后可以查看数值模式，数值1代表"),s("strong",[t._v("已勾选")]),t._v("，0代表"),s("strong",[t._v("未勾选")])]),t._v(" "),s("h3",{attrs:{id:"同步权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同步权限"}},[t._v("#")]),t._v(" 同步权限")]),t._v(" "),s("p",[t._v("为角色分配完成数据权限后，可以点击"),s("code",[t._v("Synchronization")]),t._v("按钮，为所有角色下的用户更新当前的数据权限信息")]),t._v(" "),s("p",[t._v("用户可根据需要对权限进行取消，取消权限"),s("strong",[t._v("不影响")]),t._v("角色本身权限以及其他用户权限")]),t._v(" "),s("h2",{attrs:{id:"自定义报表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义报表"}},[t._v("#")]),t._v(" 自定义报表")]),t._v(" "),s("p",[t._v("报表功能可以根据已经做好的"),s("code",[t._v("模板文件")]),t._v("进行编辑，并将所创建的模板进行填充数据，实现了动态展示报表、下载报表的功能")]),t._v(" "),s("h3",{attrs:{id:"配置数据源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置数据源"}},[t._v("#")]),t._v(" 配置数据源")]),t._v(" "),s("p",[t._v("每个报表的数据是通过数据库获取的，所以每次生成报表前都需要选择一个已配置成功的数据源，即可正常连接的数据库")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("点击配置数据源")])]),t._v(" "),s("li",[s("p",[t._v("查看所属租户是否正确")])]),t._v(" "),s("li",[s("p",[t._v("点击添加")])])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/reportDataSource.jpg"),alt:"数据源"}}),t._v(" "),s("hr"),t._v(" "),s("p",[s("strong",[t._v("配置数据源信息")]),t._v("：数据源名称、数据库ip地址、数据库名称、数据库用户名、数据库密码")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/reportAdd.jpg"),alt:"添加数据源"}}),t._v(" "),s("blockquote",[s("p",[t._v("例子：")])]),t._v(" "),s("blockquote",[s("p",[t._v("数据源名称：report")])]),t._v(" "),s("blockquote",[s("p",[t._v("数据库ip：172.1.1.1")])]),t._v(" "),s("blockquote",[s("p",[t._v("数据库名称：UAP")])]),t._v(" "),s("blockquote",[s("p",[t._v("数据库用户名：Admin")])]),t._v(" "),s("blockquote",[s("p",[t._v("数据库密码：123")])]),t._v(" "),s("p",[t._v("可以通过"),s("code",[t._v("Test Connection")]),t._v("进行数据库连接测试，测试通过即代表成功，可点击确认按钮")]),t._v(" "),s("h3",{attrs:{id:"配置报表模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置报表模板"}},[t._v("#")]),t._v(" 配置报表模板")]),t._v(" "),s("p",[t._v("配置报表模板的前提是需要你已经用报表工具做出了已经编译好的.jasper文件，通过"),s("strong",[t._v("report config")]),t._v("对做好的模板进行配置及数据填充。")]),t._v(" "),s("ul",[s("li",[t._v("添加报表组别")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/reportconfigAddName.jpg"),alt:"添加组别"}}),t._v(" "),s("ul",[s("li",[t._v("在组别内添加报表模板")]),t._v(" "),s("li",[t._v("设置模板名称")]),t._v(" "),s("li",[t._v("上传模板文件（上传前需配置properties文件中的dfs配置）")]),t._v(" "),s("li",[t._v("添加报表中的Key数据（需要和模板文件中的Key对应）")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/reportAddConfig.jpg"),alt:"配置模板"}}),t._v(" "),s("h3",{attrs:{id:"配置报表模板实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置报表模板实例"}},[t._v("#")]),t._v(" 配置报表模板实例")]),t._v(" "),s("p",[t._v("每个模板可以创建多个实例，创建出来的实例可以进行试运行、编辑、设置、删除以及设置角色权限的操作")]),t._v(" "),s("ol",[s("li",[t._v("点击添加实例按钮")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/instAdd.jpg"),alt:"添加实例"}}),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("为模板中定义的Key赋予别名（name），并且填充数据（value），在此之外还需要为当前实例添加名字以及选择数据源")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/instAdd2.jpg"),alt:"添加实例"}}),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("配置好的实例可以点击实例右边的"),s("code",[t._v("√")]),t._v("按钮进行试运行，如可以运行，说明配置成功")])]),t._v(" "),s("li",[s("p",[t._v("对于管理员来说，需要配置以上信息，平台用户仅需要在已有的模板实例上填充数据即可")])])]),t._v(" "),s("h3",{attrs:{id:"用户使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户使用"}},[t._v("#")]),t._v(" 用户使用")]),t._v(" "),s("p",[s("code",[t._v("Report View")]),t._v("选项卡是为用户操作所开发的功能，对于用户来说用户仅需要对已有的报表模板进行数据填充操作即可完成需求，因此用户仅需要了解该功能即可实现报表的查询、预览、下载等操作")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/reportView.jpg"),alt:"reportView"}}),t._v(" "),s("h2",{attrs:{id:"jasper文件工具使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jasper文件工具使用方法"}},[t._v("#")]),t._v(" Jasper文件工具使用方法")]),t._v(" "),s("p",[t._v("安装TIBCO JasperSoft Studio 后打开TIBCO JasperSoft Studio 可以看到以下界面")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCO1.jpg"),alt:"reportView"}}),t._v(" "),s("p",[t._v("界面中大致分为四个区域")]),t._v(" "),s("ul",[s("li",[t._v("工程区：主要展示当前工程的文件")]),t._v(" "),s("li",[t._v("大纲区：主要展示当前报表文件的大纲")]),t._v(" "),s("li",[t._v("工作区：编辑报表文件的区域")]),t._v(" "),s("li",[t._v("组件区：报表文件所需要的组件")])]),t._v(" "),s("h3",{attrs:{id:"tibco的基本使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tibco的基本使用方法"}},[t._v("#")]),t._v(" TIBCO的基本使用方法")]),t._v(" "),s("p",[s("strong",[t._v("新建工程")])]),t._v(" "),s("p",[t._v("File->new project->JasperReport project")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCONewPjct.jpg"),alt:"newProject"}}),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCONewPjct2.jpg"),alt:"newProject"}}),t._v(" "),s("p",[s("strong",[t._v("新建文件")])]),t._v(" "),s("p",[t._v("右键工程->new Jasper Report")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCONewPjct3.jpg"),alt:"newProject"}}),t._v(" "),s("p",[t._v("next->输入name->finish")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCONewPjct4.jpg"),alt:"newProject"}}),t._v(" "),s("p",[s("strong",[t._v("工作区&左侧工程区")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCONewPjct5.jpg"),alt:"newProject"}}),t._v(" "),s("p",[t._v("工作区：共有7个模块，对应不同的报表功能\n左侧工程区：大纲有5个模块，帮助工作区完善功能")]),t._v(" "),s("p",[t._v("具体功能见表格")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("元素")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("名词")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("style")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("样式")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("创建全局样式")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("parameter")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("参数")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("相当于Key-value")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("sort Field")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("有序字段")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("有序的映射字段")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("scriptlets")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("脚本")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Title")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("标题")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("除了第一页展示，其余不展示")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Page Header")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("页头")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("表中列的列头")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Column Header")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("列头")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("表中列的列头")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Detail")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("内容区")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("重复出现的内容在此展示")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Column Footer")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("列脚")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("表中列的列脚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Page Footer")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("页脚")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("每页都会展示，在页面下部")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Last Page Footer")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("最后一页页脚")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("只在最后一页展示")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Summary")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("统计区")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("报表最后一页中，一般用来统计")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Background")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("背景")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("设置报表的背景样式")])])])]),t._v(" "),s("p",[s("strong",[t._v("编译报表文件")])]),t._v(" "),s("p",[t._v("右键.jrxml文件,点击编译即可")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCO2.jpg"),alt:"编译"}}),t._v(" "),s("p",[s("strong",[t._v("Sql语句编写")])]),t._v(" "),s("p",[t._v("右键outline中的文件选择DataSet and QuerySet")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCO5.jpg"),alt:"编译"}}),t._v(" "),s("p",[t._v("在选项框中编写SQL语句，SQL语句查询出的数据，按照列的模式进行查询，可在工作区为每一列创建Field组件。")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/TIBCO6.jpg"),alt:"编译"}}),t._v(" "),s("p",[t._v("具体TIBCO使用方法文档可参照\n"),s("a",{attrs:{href:"https://www.jianshu.com/p/999d8e6c8f6c",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文档"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"文件系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件系统"}},[t._v("#")]),t._v(" 文件系统")]),t._v(" "),s("h3",{attrs:{id:"uap-dfs-jar下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uap-dfs-jar下载"}},[t._v("#")]),t._v(" uap-dfs.jar下载")]),t._v(" "),s("p",[t._v("文件系统目前支持本地配置及fastDfs分布式文件系统两种文件存储方式。UAP提供了"),s("code",[t._v("uap-dfs.jar")]),t._v("包实现了对本地及fastDfs中的文件存储、更新及删除操作，开发者使用前先到公司maven仓库下载最新的"),s("code",[t._v("uap-dfs.jar")])]),t._v(" "),s("h3",{attrs:{id:"uap-dfs-jar使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uap-dfs-jar使用"}},[t._v("#")]),t._v(" uap-dfs.jar使用")]),t._v(" "),s("p",[t._v("在项目的pom中引入uap-dfs.jar的依赖，进行相关配置（参见配置手册），jar包中提供了"),s("code",[t._v("FastDfsClient")]),t._v("和"),s("code",[t._v("LicalClient")]),t._v("两个工具类，开发者可直接调用工具类中的方法对文件进行操作")]),t._v(" "),s("h2",{attrs:{id:"配置管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置管理"}},[t._v("#")]),t._v(" 配置管理")]),t._v(" "),s("h3",{attrs:{id:"配置管理开发步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置管理开发步骤"}},[t._v("#")]),t._v(" 配置管理开发步骤")]),t._v(" "),s("h4",{attrs:{id:"uap-config-jar下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uap-config-jar下载"}},[t._v("#")]),t._v(" uap-config.jar下载")]),t._v(" "),s("p",[t._v("UAP统一配置管理中心能够集中化管理不同应用配置，提供了统一的配置管理界面，配置修改后可以及时生效（20秒内），针对配置的修改提供了审计日志方便跟踪。")]),t._v(" "),s("p",[t._v("开发者使用前需要先到公司的maven仓库下载最新的uap-config.jar包")]),t._v(" "),s("h4",{attrs:{id:"配置项开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置项开发"}},[t._v("#")]),t._v(" 配置项开发")]),t._v(" "),s("p",[t._v("在pom中添加如下依赖")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.hexing.uap"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("uap-config"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${project.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("保证uap-config包能够被扫描到，推荐使用spring-boot工程\n为项目启动类添加")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ComponScan")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("basePackage "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v('"com'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hexing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("nameGenerator "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UapBeanNameGenerator")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在properties文件中添加配置项"),s("code",[t._v("uap.client.uapUrl")]),t._v("配置UAP服务地址")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uap.client.uapUrl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("http://172.**.**.**:8080/uap")]),t._v("\n")])])]),s("p",[t._v("在配置类上添加注解 "),s("strong",[t._v("@UapConfigBean")]),t._v("\n在配置属性上添加 "),s("strong",[t._v("@UapConfigField")]),t._v(" 并填写value值")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@UapConfigBean")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BpmAnnoTest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@UapConfigField")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@UapConfigField")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"integer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@UapConfigField")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"boolean"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Boolean")]),t._v(" isAdmin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("在使用处直接声明配置类，即可获取配置属性最新值，如下所示")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyConfigTest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[s("strong",[t._v("注：")]),t._v("\n配置类上只允许添加@UapConfigBean注解，不可添加@Component等注解\n业务应用启动时需保证UAP应用已经启动成功并且正确配置UAP服务地址")]),t._v(" "),s("h4",{attrs:{id:"备注"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备注"}},[t._v("#")]),t._v(" 备注")]),t._v(" "),s("p",[t._v("配置管理的配置项包括："),s("code",[t._v("用户密码过期时间")]),t._v("，"),s("code",[t._v("日志保留时间")]),t._v("，"),s("code",[t._v("用户密码允许错误次数")]),t._v("，"),s("code",[t._v("用户Token有效期")]),t._v("，"),s("code",[t._v("调度中心地址")]),t._v("等。\n配置管理项不包括 "),s("s",[t._v("数据库地址")]),t._v(" 、"),s("s",[t._v("redis地址")]),t._v("等启动项")]),t._v(" "),s("p",[t._v("配置项校验目前仅支持"),s("strong",[t._v("string")]),t._v("、"),s("strong",[t._v("boolean")]),t._v("、"),s("strong",[t._v("integer")]),t._v("三种类型的校验")]),t._v(" "),s("h2",{attrs:{id:"审计功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#审计功能"}},[t._v("#")]),t._v(" 审计功能")]),t._v(" "),s("h3",{attrs:{id:"审计流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#审计流程"}},[t._v("#")]),t._v(" 审计流程")]),t._v(" "),s("p",[t._v("流程图")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/develop/audit1.jpg"),alt:"审计流程图"}}),t._v(" "),s("h3",{attrs:{id:"审计开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#审计开发"}},[t._v("#")]),t._v(" 审计开发")]),t._v(" "),s("p",[t._v("UAP审计相关代码都在uap-common.jar包中，其他模块可引入该报。集成要点如下：")]),t._v(" "),s("ol",[s("li",[t._v("本模块的所有需要审计的实体类都要实现IAudit接口，该接口方法")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("auditSign")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回当前实体类所代表的数据名称")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("primaryKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回每条数据的具备唯一性的特征值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("auditFields")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回当前类需要参与审计的字段名。如果此合计不为空，则会记录不在本集合内的所有字段")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("excludeFields")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回氮气类不参与审计的字段名。如果为空，则会记录不在本合集内的所有字段")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sensitiveFields")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回当前类的私密或敏感的字段名。在记录是此字段会模糊处理")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("继承审计处理的切面抽象类 AbsAuditAspert，填写相关方法的切面表达式，在运行中通过切面表达式拦截相关的方法，并收集数据。主要有以下切点：")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("savePointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截新增或修改单个对象的方法，方法执行完后要返回最新数据，切面方法返回的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("saveBitchPointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截新增或修改多个对象的方法，方法执行完后要返回最新数据，切面方法返回的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deletePointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截删除单个对象的方法，，切面方法返回的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteBitchPointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截删除多个对象的方法，，切面方法返回的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findPointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截查找单个对象的方法，切面方法返回的数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findCachePointCut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//拦截查找缓存中单个对象的方法，切面方法返回的数据")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("在前端请求到达后端时，拦截请求，判断请求接口是否需要审计，如果需要审计，在当前线程变量中添加审计标识，并创建审计处理对象AuditHander，放入线程。uap-common包中提供AuditUtil工具类可完成以上工作")])]),t._v(" "),s("li",[s("p",[t._v("在后端结果返回时，通过线程中的AuditHander对象处理审计数据。无论结果成功或失败都要确保清理一次线程变量，以避免线程池参与变量污染后续请求")])]),t._v(" "),s("li",[s("p",[t._v("对于部分无法按常规方式手机审计数据情况，AuditUtil工具提供收到添加审计记录的功能")])]),t._v(" "),s("li",[s("p",[t._v("使用uap-common提供的审计功能，要求工程代码结构比较规范，否则切面表达式可能很难写")])]),t._v(" "),s("li",[s("p",[t._v("如不使用uap-common提供的审计功能，可自行在业务中收集审计数据，调用UAP提供的审计记录接口")])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("POST:/audit\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);